<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.beetmall.sshj.dao.ProductDAO">
	<select id="productAllSelect" resultType="com.beetmall.sshj.vo.ProductVO">
	 	select  p.productnum,c.catenum,c.catename,m.mcatenum,m.mcatename,p.productname,p.thumbimg,p.productprice,p.totalstock,
				to_number(p.productprice - d.saleprice) sellprice,
				to_char(p.sellstart, 'YY/MM/DD') sellstart , to_char(p.sellfinish, 'YY/MM/DD') sellfinish, 
             	d.saleprice, floor(( d.saleprice/p.productprice)*100) as salepercent, 
             	to_char(d.salestart, 'YY/MM/DD') salestart, to_char(d.salefinish, 'YY/MM/DD') salefinish
		from product p
		join mcategory m on m.mcatenum = p.mcatenum
		join category c on c.catenum = m.catenum
		join discount d on d.productnum = p.productnum
        where p.userid = 'kimseller'
		group by c.catenum,c.catename,m.mcatenum,m.mcatename,p.productnum,p.productname,p.thumbimg ,p.productprice,p.totalstock,p.sellstart,p.sellfinish,d.saleprice,d.salestart,d.salefinish 
		order by p.sellstart desc 
	</select>

	<insert id="productInsert" parameterType="com.beetmall.sshj.vo.ProductVO">
		insert into product (productnum, userid, mcatenum, productname, productprice, saleselect, saleb, optionselect,
								sellstart,sellfinish, totalstock, nowstock, thumbimg, addimg,
                    			productcontent, deliveryoption, deliverprice, paymentoption, selloption, sellweight,
                     			origin, wrapping, productinfomation, prevention, deadline)
                     			
       	values(productsq.nextval, #{productnum}, #{userid}, #{mcatenum}, #{productname}, #{productprice}, #{saleselect}, #{saleb}, #{optionselect}
       			#{sellsatart},#{sellfinish},#{totalstock},#{nowstock},#{thumbimg},#{addimg},
       			#{productcontent}, #{deliveryoption}, #{deliverprice}, #{paymentoption}, #{selloption}, #{sellweight}, 
       			#{origin}, #{wrapping}, #{productinformation}, #{prevention}, #{deadline})       				
	</insert>
	
</mapper>