<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.beetmall.sshj.custom.dao.RecipeDAO">
    <select id="RecipeAllList" resultType="com.beetmall.sshj.custom.vo.RecipeVO">
        select recipenum ,userid ,recipetitle ,recipecontent ,recipemainimg, 
        to_char(recipewritedate,'MM-DD HH:MI')recipewritedate,reciperecommend,recipehit from recipe
        order by recipenum desc     
    </select>
    <insert id="recipeWriteOk" parameterType="com.beetmall.sshj.custom.vo.RecipeVO">
       insert into recipe 
       values(recipesq.nextval,'tester',#{recipetitle},#{recipecontent},#{recipemainimg},sysdate,0,0)
    </insert>
    
    <delete id="recipeDelete">
		delete from recipe where recipenum=#{param1}
	</delete>
	
	<update id="recipeEditeOk" parameterType="com.beetmall.sshj.custom.vo.RecipeVO">
		update recipe set recipetitle=#{recipetitle}, recipecontent=#{recipecontent} where recipenum=#{recipenum}
	</update>
    
    <select id="selectLastSelect" resultType="com.beetmall.sshj.custom.vo.RecipeVO">
    select recipenum from( select * from (recipe) order by recipeWritedate DESC)where ROWNUM = 1    
    </select> 
    <select id="RecipeSelect" resultType="com.beetmall.sshj.custom.vo.RecipeVO">
    select recipenum, userid, recipetitle, recipecontent, recipemainimg, to_char(recipewritedate,'YY/MM/DD HH:MI') as recipewritedate,reciperecommend,recipehit from recipe where recipenum=${param}
    </select>   
    <select id="recipeAllListHome" resultType="com.beetmall.sshj.custom.vo.RecipeVO">
        select recipenum ,userid ,recipetitle ,recipecontent ,recipemainimg, 
        to_char(recipewritedate,'MM-DD HH:MI')recipewritedate,reciperecommend,recipehit from recipe
        order by recipenum desc     
    </select>   
    
    <select id="recipeAllListHome2" resultType="com.beetmall.sshj.custom.vo.RecipeVO">
        select recipenum ,userid ,recipetitle ,recipecontent ,recipemainimg, 
        to_char(recipewritedate,'MM-DD HH:MI')recipewritedate,reciperecommend,recipehit from recipe
        order by reciperecommend desc     
    </select> 
 
    <select id="customMyrecipe" resultType="com.beetmall.sshj.custom.vo.RecipeVO">
        select  recipenum,recipetitle,userid,recipemainimg, 
        to_char(recipewritedate,'MM-DD HH:MI')recipewritedate,reciperecommend,recipehit from recipe
        order by recipenum desc     
    </select>  
    
    <update id="recigoodOk" parameterType="com.beetmall.sshj.custom.vo.RecipeVO">
       update recipe set reciperecommend=reciperecommend+1 where recipenum=#{param1}
    </update>
    
    <insert id="recigoodOk2" parameterType="com.beetmall.sshj.custom.vo.FavoriteVO">
       insert into favorite(recipegoodnum,userid) VALUES(#{param1},#{param2})
    </insert>

    <select id="recigoodOnly" resultType="com.beetmall.sshj.custom.vo.FavoriteVO">
     select count(recipegoodnum) from favorite where userid=#{param2} and recipegoodnum=#{param1}
     </select>
    
    <insert id="recikeepOk" parameterType="com.beetmall.sshj.custom.vo.FavoriteVO">
       insert into favorite(recipenum,userid) VALUES(#{param1},#{param2})
    </insert>
    
    <select id="recikeepOnly" resultType="com.beetmall.sshj.custom.vo.FavoriteVO">
     select count(recipenum) from favorite where userid=#{param2} and recipenum=#{param1}
     </select>
     
    <select id="customMyrecipe2" resultType="com.beetmall.sshj.custom.vo.RecipeVO">
        select b.recipenum,b.recipetitle,b.userid,b.recipemainimg,b.reciperecommend,b.recipehit from 
        (select r.recipenum,r.recipetitle,r.userid,r.recipemainimg,r.reciperecommend,
        r.recipehit from recipe r join favorite f on r.recipenum=f.recipenum)b 
        where b.userid=#{param1}
    </select>  
    
    <update id="recipeHit" parameterType="com.beetmall.sshj.custom.vo.RecipeVO">
       update recipe set recipehit=recipehit+1 where recipenum=#{param1}
    </update>
    
    
    
 
  </mapper>